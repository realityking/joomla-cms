/*
		GNU General Public License version 2 or later; see LICENSE.txt
*/
var JFormValidator=new Class({initialize:function(){this.handlers={};this.custom={};this.setHandler("username",function(a){regex=/[<|>|"|'|%|;|(|)|&]/i;return!regex.test(a)});this.setHandler("password",function(a){regex=/^\S[\S ]{2,98}\S$/;return regex.test(a)});this.setHandler("numeric",function(a){regex=/^(\d|-)?(\d|,)*\.?\d*$/;return regex.test(a)});this.setHandler("email",function(a){regex=/^[a-zA-Z0-9._-]+(\+[a-zA-Z0-9._-]+)*@([a-zA-Z0-9.-]+\.)+[a-zA-Z0-9.-]{2,4}$/;return regex.test(a)});$$("form.form-validate").each(function(a){this.attachToForm(a)},
this)},setHandler:function(a,b,c){this.handlers[a]={enabled:""==c?!0:c,exec:b}},attachToForm:function(a){a.getElements("input,textarea,select,button").each(function(a){a.hasClass("required")&&(a.set("aria-required","true"),a.set("required","required"));("input"==document.id(a).get("tag")||"button"==document.id(a).get("tag"))&&"submit"==document.id(a).get("type")?a.hasClass("validate")&&(a.onclick=function(){return document.formvalidator.isValid(this.form)}):a.addEvent("blur",function(){return document.formvalidator.validate(this)})})},
validate:function(a){a=document.id(a);if(a.get("disabled"))return this.handleResponse(!0,a),!0;if(a.hasClass("required"))if("fieldset"==a.get("tag")&&(a.hasClass("radio")||a.hasClass("checkboxes")))for(var b=0;;b++)if(document.id(a.get("id")+b)){if(document.id(a.get("id")+b).checked)break}else return this.handleResponse(!1,a),!1;else if(!a.get("value"))return this.handleResponse(!1,a),!1;b=a.className&&-1!=a.className.search(/validate-([a-zA-Z0-9\_\-]+)/)?a.className.match(/validate-([a-zA-Z0-9\_\-]+)/)[1]:
"";if(""==b)return this.handleResponse(!0,a),!0;if(b&&("none"!=b&&this.handlers[b]&&a.get("value"))&&!0!=this.handlers[b].exec(a.get("value")))return this.handleResponse(!1,a),!1;this.handleResponse(!0,a);return!0},isValid:function(a){for(var b=!0,a=a.getElements("fieldset").concat(Array.from(a.elements)),c=0;c<a.length;c++)!1==this.validate(a[c])&&(b=!1);(new Hash(this.custom)).each(function(a){!0!=a.exec()&&(b=!1)});return b},handleResponse:function(a,b){b.labelref||$$("label").each(function(a){a.get("for")==
b.get("id")&&(b.labelref=a)});!1==a?(b.addClass("invalid"),b.set("aria-invalid","true"),b.labelref&&(document.id(b.labelref).addClass("invalid"),document.id(b.labelref).set("aria-invalid","true"))):(b.removeClass("invalid"),b.set("aria-invalid","false"),b.labelref&&(document.id(b.labelref).removeClass("invalid"),document.id(b.labelref).set("aria-invalid","false")))}});document.formvalidator=null;window.addEvent("domready",function(){document.formvalidator=new JFormValidator});
